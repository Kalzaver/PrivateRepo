# Задача №5 - реализовать некоторые из функций в программном коде для оценки технологичесого риска реализацииний

## Процесс решения

В процессе разработки тестовой программы на фреймфорке QT для языка программирования C++ опытным путём выяснилось, что изменение готового шаблона в odt формате не представляется возможным через нахождение маркера на строке и его замены на нужные данные. Структура файла нарушается и возможность его чтения после внесения изменений не представлялась возможной. Данная особенность требует большего изучения и нахождения другого способа модификации файла для сохранения возможности чтения и без потери файла.
Выяснилось, что данный формат хранения информации, разработанный OASIS (Организация по развитию стандартов структурированной информации), представляет собой запакованный ZIP-архив из файлов XML и файлов изображений. Изменение подобного рода структуры без таргетированного модифицирования файлов XML при помощи библиотек с сохранением возможности открытия файла возможно. 

При тестовых сборках программ на фреймворке Qt версии 6.5 стало известно о существовании библиотеки QuaZip для запаковывания файла обратно в odt формат. Однако для новейшей версии Qt, используемая в проекте, данная библиотека не подходит в виду использования устаревшего компонента из Qt пятой версии и отсутствия должной поддержки уже несколько лет. Библиотека ищёт нового вендера и пока безуспешно.

Для решения проблемы с запаковкой архива обратно в odt формат можно использовать вызов архиватора напрямую из программы. После распаковки файла в папку, где будут хранится xml и png файлы необходимо заархивировать содержимое папки обратно. Программы архиваторы не поддерживают архивацию в формат odt. Сначала нужно запаковать файлы и папки в zip архив, а далее сменить ему имя. Таким образом получится прочесть файл. В тестовой реализации удалось реализовать программу по вводу текстовых значений через элемент lineEdit для последующей замены маркеров внутри content.xml. После замены, архивации и смены расширения получилось создать файл odt для чтения, доступный для чтения через LibreOffice вместе с изображениями. Однако каждое открытие файла сопровождается уведомлением о повреждении файла, что заставляет  LibreOffice восстанавливать файл. Приложению это удаётся сделать, возможность чтения сохраняется.

Другим способом модификации документа, без смены формата на odt и работы по изменению xml файла, может стать работа с библиотекой duckx. Единственная проблема перед её использованием - компиляция библиотеки собсивенными средствами и исправления программного кода для корректной сборки. Первоначалный автор не завершил её разработку.
