# Задача - выбор метода заполнения готовых шаблонов документов без потери первоначального вида с сохранением наложенных изображений

## Процесс решения

Головная организация - автор документов в формате Word для занесения информации по различным категориям и мероприятиям. Шаблоны, которые на данный момент заполняются от руки, утверждены РКФ и не могут быть изменены. 
Проблема - заполнение шаблонов документов информацией таким образом, чтобы не менять структуру документа и сохранить все полупрозрачные изображения на их первоначальных местах.
Возможные решения:

- создание предварительных пользовательских форм для заполнения и перенос из них информации в шаблонный документ Word
- преобразование файлов Word в PDF и настройка заполняемых полей

Рассмотрим каждый из вариантов и выберем наиболее удобный по степени сложности реализации.
В первом случае стоит помнить об особенностях работы с файлами Word. При заполнении документов таким образом весь набранный текст имеет свойство сдвигаться по строкам, поэтому для корректного заполнения шаблонов от РКФ необходимо предварительно посчитать количество допустимых к вводу символов для каждого поля. 
Следующая особенность в работу с Word документами - технический вопрос. Для работы с файлами необходимо их заранее преобразовать в другие форматы для обеспечения возможности заполнения при помощи программного кода. Для корректной работы необходимо работать с ZIP и XML файлами. Это повышает сложность сохранения у документа его первоначального вида и повышает риск нарушения его структуры, что в случае системы недопустимо.
Важной особенностью в работе с Word форматом является использование соответствующих технологий. Заполнение файлом может быть реализовано при помощи COM-объектов, но это трудозатратно и требует наличие Microsoft Word на стороне клиента и сервера. Также данный способ ограничивает нас в возможности портирования сервиса на другие платформы кроме персональных компьютеров на операционной системе Windows.
Последняя из выявленных проблем, лежащих на поверхности, это различия в работе с файлами Word различных версий программы. Отличие версии гарантирует разность в восприятии электронным устройством информации из файла и нарушение разметки внутри файла, что недопустимо для системы.

Во втором случае решается несколько из выше упомянутых проблем и сложностей работы с документами в формате Word. Во-первых, PDF файлы не подвержены сдвигу текста при его вводе в заполняемые поля. Во-вторых, версионность не подвергает разметку информации внутри файлов изменениям. В-третьих, для обработки PDF файлов достаточно подключения специальных библиотек, нет необходимости преобразовывать файлы в ZIP и XML как в первом случае. Однако, данный метод имеет свои недоставки в том числе. По сколько такие файлы изначально не подразумевают заполнение, необходимо вставить поля для ввода текста. Далее рассчитать количество символов для корректного отображения после переноса текста из формы в поле. Как отмечалось ранее Word имеет ограничения в работе на других системах. PDF не имеет таких ограничений и имеет возможность отрисовки для всех известных платформах, что делает его более универсальным в использовании.

В конечном итоге, вариант с использованием PDF с полями для заполнения будет удобнее и практичнее.